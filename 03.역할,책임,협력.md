# 03. 역할,책임,협력

- 객체지향의 본질 - 협력하는 객체들의 공동체를 창조하는 것
- 클래스, 상속 - 객체들의 책임과 협력이 자리잡으면 사용할 수 있는 구현 메커니즘
- 너무 이른 시기에 구현 - 변경하기 어려운 코드의 원인

## 1.협력

### 영화 예매 시스템 돌아보기

- 다양한 객체들이 기능을 구현하기 위해 메시지를 주고 받으면서 상호작용
- 객체들이 기능을 구현하기 위해 수행하는 상호작용 - 협력
- 객체가 협력에 참여하기 위해 수정하는 로직 - 책임
- 객체들이 협력안에서 수행하는 책임들이 모여 - 역할

### 협력

- 메시지 전송 - 객체 사이의 협력을 위한 유일한 수단
- 메시지를 수신한 객체는 메서드를 실행해 응답
- 캡슐화 - 객체를 자율적으로 만드는 기본적 방법

### 협력이 설계를 위한 문맥을 결정한다

> 어떤 객체도 섬이 아니다.
> 애플리케이션 안에 객체가 필요하다면 그 이유는 단 하나여야 한다.
> 그 객체가 어떤 협력에 참여하고 있기 때문이다.
> 그리고 객체가 협력에 참여할수 있는 이유는 협력에 필요한 적절한 행동을 보유하고 있기 때문이다.

- 협력 - 객체의 행동을 결정
- 객체의 상태
  - 그 객체가 행동을 수행하는데 필요한 정보가 무엇인지로 결정
  - 객체는 스스로 결정하고 관리하는 자율적인 존재이기에 행동을 위한 상태가 있어야 한다.
- 협력이 객체를 설계하는데 필요한 문맥(context)를 제공
  - 협력이 객체를 구성하는 행동과 상태를 결정

## 2. 책임

### 책임이란 무엇인가

- 협력에 참여하기 위해 객체가 수행하는 행동
- 하는 것 / 아는 것
- 책임
  - 객체가 수행할 수 있는 행동을 종합적이고 간력하게 서술
  - 메시지보다 추상적이고 개념적으로 더 크다
- 아는것
  - 책임을 수행하는데 필요한 정보를 알아야할 책임
  - 자신이 할 수 없는 작업을 도와줄 객체를 알고 있을 책임
    > 객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는 것
- 적절한 협력이 적절한 책임 제공 / 절절한 책임을 적절한 객체에 할당 ==> 단순하고 유연한 설계

### 책임 할당

- 정보 전문가 패턴 (information expert pattern)
  - 책임을 수행하는데 필요한 정보를 가장 잘 알고 있는 전문가에게 책임을 할당
- 협력에 필요한 지식과 방법을 가장 잘 알고 있는 객체에게 도움을 요청
- 요청에 응답하기 위한 행동이 객체가 수행할 책임으로 이어짐
- 협력을 설계
  - 사용자에 제공하는 기능을 시스템이 담당하는 하나의 책임으로 인식
  - 객체지향 설계 - 책임을 완료하는데 필요한 더 작은 책임을 찾아서 이를 객체들에 할당하는 과정의 반복
- 이렇게 결정된 메시지가 객체의 퍼블릭 인터페이스를 구성

### 책임 주도 설계

1. 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악
2. 시스템 책임을 더 작은 책임으로 분할
3. 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당
4. 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체,역할을 찾는다.
5. 해당 객체 또는 역할에게 책임을 할당하여 두 객체가 협력하게 한다.

- 객체의 구현이 아닌 책임에 집중

### 메세지가 객체를 결정한다

- 필요한 메시지를 먼저 식별하고 메시지를 처리할 객체를 나중에 선택
- 메시지가 객체를 선택하는 중요 이유
  1. 최소한의 인터페이스를 가질 수 있게 된다.
  2. 충분히 추상적인 인터페이스를 가질 수 있게 된다.
     - 무엇만 표현하고 어떻게는 노출하면 안 된다.

### 행동이 상태를 결정한다

- 객체를 객체답게 만드는 것으은 상태가 아니라 객체가 다른 객체에 제공하는 행동
- 시스템의 기능을 구현하기 위한 렵력에 초점을 맞춰야 응집도가 높고 결합도가 낮은 객체들을 창조 가능
- 상태 - 객체가 행동을 수행하기 위한 재료일 뿐

## 3. 역할

### 역할과 협력

- 역할 - 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합
- 책임 할당 - 객체가 아닌 역할에 할당한다
- 책임 할당 과정
  1. 적절한 역할을 찾는다.
  2. 역할을 수행할 객체를 찾는다.

### 유연하고 재사용 가능한 협력

- 역할 - 구체적인 객체를 포괄하는 추상화
- 동일한 책임을 수행하는 역할을 기반으로 여러 협력을 하나로 통합

> 역할을 구현하는 가장 일반적인 방법은 추상클래스와 인터페이스
>
> 협력의 관점에서 추상클래스와 인터페이스는 구체 클래스들이 따라야 하는 책임의 집합

### 객체 대 역할

- 역할 - 객체가 참여할 수 있는 일종의 슬롯
- 협력에 참여하는 후보가 여러 종류의 객체에 의해 수행되야 되면 역할
- 한 종류의 객체만이 협력이 참여할 필요가 있다면 객체
- 협력 -> 역할 -> 객체 -> 클래스
- 사람이 이해할 때 개념, 객체, 역할을 뒤섞는다.
- 역할과 객체를 명확하게 구분하는 것이 중요하지는 않다.
- 구분이 어렵다면 객체로 시작하고 후에 필요해 따라 역할을 분리
  > 다양한 객체들이 협력에 참여한다는 것이 확실하다면 역할로 시작
  > 결정이 어렵다면 구체적인 객체로 시작
  > 다양한 시나리오를 탐색하고 유사한 협력들을 단순화하고 합치다보면 자연스럽게 역할이 나타날 것이다.

### 역할과 추상화

1. 중요한 정책을 상위 수준에서 단순화
   - 세부사항을 생략하고 핵심적인 개념 강조 가능
2. 설계가 좀 더 유연해짐
   - 역할이 다양한 종류의 객체를 끼워 넣을 수 있는 일종의 슬롯
   - 동일한 책임을 수행하는 객체들은 동일한 역할을 하기에 대체가 가능

### 배우와 배역

- 객체는 다양한 역할을 가질 수 있다.
- 협력 안에서는 하나의 역할로 보여짐
- 협력의 관점에서 동일한 역할을 수행하는 객체는 대체 가능
- 역할은 특정한 객체의 종류를 캡슐화하기에 동일한 역할을 수행하고 계약을 준수하는 대체 가능한 객체들은 다형적
